<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>17-regression-grillen.knit</title>

  
   
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="17-regression-grillen.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="17-regression-grillen.knit" />
  
  
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.3.1/transition.js"></script>
    <script src="libs/bs3compat-0.3.1/tabs.js"></script>
    <script src="libs/bs3compat-0.3.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <style>
    #content {
        font-size: 0.95rem;
    }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="bs4_style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<!--bookdown:title:start-->
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title=""></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
 
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="regression" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Regression</h1>
<p>Anhand des Zirpens von Grillen kann man mehr oder weniger verlässlich die Lufttemperatur berechnen. Die Körperfunktionen von Grillen verändert sich wie bei anderen Insekten auch durch veränderte Lufttemperatur. Wie alle Insekten sind Grillen kaltblütig und nehmen die sie umgebende Temperatur an. Je wärmer, desto häufigeres Zirpen, denn: Ist es wärmer, laufen die Körperfunktionen – wie auch Bewegungen – schneller ab, die Grillen sind aktiver. […] Da Grillen also bei erhöhter Temperatur häufiger Zirpen, kann man aus der Häufigkeit des Zirpens die Lufttemperatur ableiten. Die Formel dafür ist sehr simpel. Um die Temperatur in Grad Celsius zu errechnen, zählt man das Zirpen einer einzelnen Grille in einem Intervall von 25 Sekunden. (<a href="https://www.heute.at/s/so-verraten-ihnen-grillen-die-aktuelle-temperatur-54218483">Quelle</a>)</p>
<div id="dataset" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Dataset</h2>
<p>Nehmen wir an, dass folgende kleine Menge von labelled examples vorliegt:</p>
<p><img src="assets/16-regression-grillen.assets/image%20(136).png" style="width:100.0%" /></p>
<p>Natürlich wollen wir nun - wie üblich - aus dem Feature-Vektor den Label vorhersagen. Offensichtlich handelt es sich um ein Regressionsproblem. Nachfolgendes Bild visualisiert die labelled examples:</p>
<div class="figure">
<img src="assets/16-regression-grillen.assets/image-20211205172941481.png" style="width:100.0%" alt="" />
<p class="caption">Chirps-Featues (x-Achse) und Labels (y-Achse)</p>
</div>
<p>Hier der Python Code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>chirps <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Count&quot;</span>: [<span class="dv">31</span>,<span class="dv">16</span>,<span class="dv">29</span>,<span class="dv">43</span>,<span class="dv">27</span>,<span class="dv">19</span>,<span class="dv">47</span>,<span class="dv">9</span>,<span class="dv">45</span>,<span class="dv">5</span>,<span class="dv">39</span>],</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Temp&quot;</span>: [<span class="fl">9.4</span>,<span class="fl">10.5</span>,<span class="fl">17.1</span>,<span class="fl">24.3</span>,<span class="fl">14.6</span>,<span class="fl">9.9</span>,<span class="fl">16.9</span>,<span class="fl">6.4</span>,<span class="fl">17.7</span>,<span class="fl">7.5</span>,<span class="fl">14.2</span>]    </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">9</span>))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>ax.set_aspect(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&quot;Chirps-Data&quot;</span>) </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&quot;Count&quot;</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&quot;Temperature&quot;</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">35</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data <span class="op">=</span> chirps, x <span class="op">=</span> <span class="st">&quot;Count&quot;</span>, y<span class="op">=</span><span class="st">&quot;Temp&quot;</span>, label<span class="op">=</span><span class="st">&quot;Temp&quot;</span>)</span></code></pre></div>
</div>
<div id="modellfamilie" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Modellfamilie</h2>
<p>Unsere Modellfamilie sind die linearen Funktionen <span class="math inline">\(M_{w,b} : \mathbb{R} \rightarrow \mathbb{R}\)</span>, definiert durch</p>
<p><span class="math display">\[
M_{w,b}(x) = x \cdot w +b
\]</span></p>
<p>Wir suchen also <span class="math inline">\(w\)</span> und <span class="math inline">\(b\)</span> in <span class="math inline">\(\mathbb{R}\)</span>, so dass unser dadurch definiertes Modell unseren Datensatz möglichst gut vorhersagt. Offenbar ist <span class="math inline">\(M\)</span> für fest gewähltes <span class="math inline">\(w\)</span> und <span class="math inline">\(b\)</span> eine lineare Funktion, die wir gut visualisieren können.</p>
<div id="übung" class="section level4 unnumbered">
<h4 class="unnumbered">Übung</h4>
<ol style="list-style-type: decimal">
<li>Tragen sie die Funktion (Gerade) <span class="math inline">\(M_{2,5}\)</span> in das Koordinatensystem in diesem <a href="https://hawlandshutde-my.sharepoint.com/:p:/g/personal/dgreipl_az_haw-landshut_de/EVP2qxD2yfhFspTxcEiDBA8BSx3up_SbE0lADod7WLM9EQ?e=e5h7mw">Link</a> in <strong>die erste Folie</strong> ein.</li>
<li>Tragen sie die aus Ihrer Sicht beste Gerade für obigen Datensatz in das Koordinatensystem in diesem <a href="https://hawlandshutde-my.sharepoint.com/:p:/g/personal/dgreipl_az_haw-landshut_de/EVP2qxD2yfhFspTxcEiDBA8BSx3up_SbE0lADod7WLM9EQ?e=e5h7mw">Link</a> <strong>in die zweite Folie</strong> ein. Nennen sie eine Abschätzung für Gewicht <span class="math inline">\(w\)</span> und Bias <span class="math inline">\(b\)</span> dieser Gerade.</li>
</ol>
</div>
</div>
<div id="fehlerfunktion-loss" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Fehlerfunktion (Loss)</h2>
<p>Um die Qualität eines gewählten Modells zu verwenden verwenden wir den schon bekannten MSE:</p>
<p><span class="math display">\[
\text{MSE}(w,b) = \frac{1}{n}\sum_{i=0}^{n-1} (M_{w,b}(x_i) -y_i) ^2
\]</span></p>
<p>für alle <span class="math inline">\(n\)</span> labelled examples <span class="math inline">\((x_i,y_i)\)</span> aus dem Dataset. Durch Einsetzen der Definition von <span class="math inline">\(M\)</span> ergibt sich nun:</p>
<p><span class="math display">\[
\begin{align*}
\text{MSE}(w,b)
    &amp;= \frac{1}{n}\sum_{i=0}^{n-1} ( x_i\cdot w + b - y_i ) ^2
\end{align*}
\]</span></p>
</div>
<div id="visualisierung-der-fehlerfunktion" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Visualisierung der Fehlerfunktion</h2>
<p>Der MSE ist eine reelle Zahl, die von w und b abhängt. Wir können daher den MSE-Graph als Fläche über der Weight-Bias Eben plotten. Der Pfeil zeigt auf den Wert von <span class="math inline">\(w\)</span> und <span class="math inline">\(b\)</span>, an dem wir das Minimum der Fehlerfunktion erwarten.</p>
<div class="figure">
<img src="assets/16-regression-grillen.assets/image%20(138)%20(1).png" style="width:100.0%" alt="" />
<p class="caption">Fehlerfunktion im 3D Plot</p>
</div>
<p>Am tiefsten Punkt der Fläche haben wir das beste Modell gefunden. Der kleine Punkt in der Grafik markiert in etwa diesen Punkt. Aber wir kommen wir dorthin?</p>
</div>
<div id="gradientenabstieg-gradient-descent" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Gradientenabstieg (<em>gradient descent</em>)</h2>
<p>Wir haben eben gesehen, dass die Fehlerfunktion MSE nur von w und b abhängt. Das Minimum von Funktionen lässt sich unter bestimmten Umständen, so wie in diesem Beispiel, durch die erste Ableitung berechnen. In der Praxis gelingt das aber nur selten. Erfolgversprechender ist das sukzessive Absteigen auf der Fläche. Da unserer Fehlerfunktion differenzierbar ist, ist der negative Gradient die beste Abstiegsrichtung. In folgender Abbildung ist zur Verdeutlichung ein willkürlicher “Abstiegspfad” eingezeichnet:</p>
<p><img src="assets/16-regression-grillen.assets/image%20(125).png" style="width:100.0%" /></p>
<p>Das Abstiegsverfahren lässt sich etwas besser anhand eines Grafen einer Loss-Funktion <span class="math display">\[L: \mathbb{R} \rightarrow \mathbb{R}\]</span> veranschaulichen. Wir nehmen dabei an, dass wir den Loss (=MSE) nur entlang der w-Achse minimieren wollen, also angenommen, dass der Loss nur von <span class="math inline">\(w\)</span> abhängt.</p>
</div>
<div id="skizzierung-des-abstiegsverfahrens" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Skizzierung des Abstiegsverfahrens</h2>
<p>Ist L differenzierbar und <span class="math inline">\(L´(w_0) &lt; 0\)</span> für einen zufällig gewählten Startwert <span class="math inline">\(w_0\)</span> , so gilt wegen
<span class="math display">\[
L^´(w_0) = \lim_{h \rightarrow 0} \frac{L(w_0+h) - L(w_0)}{h}  &lt;0
\]</span>
für hinreichend kleines <span class="math inline">\(h_0 &gt; 0\)</span>:
<span class="math display">\[
\frac{L(w_0+h_0) - L(w_0)}{h_0}  &lt;0
\]</span>
und damit
<span class="math display">\[
L(w_0+h_0) &lt; L(w_0)
\]</span>
Nun setzt man <span class="math inline">\(w_1 = w_0 + h_0\)</span> und fährt weiter fort.</p>
<div id="übung-1" class="section level4 unnumbered">
<h4 class="unnumbered">Übung</h4>
<p>Führen Sie obige Überlegung für den Fall <span class="math inline">\(L´(w_0) &gt; 0\)</span> durch. Wie seht dann <span class="math inline">\(w_1\)</span> aus?</p>
</div>
</div>
<div id="optimales-modell-mit-python" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> Optimales Modell mit Python</h2>
<p>Wir können die optimalen Paramater (relativ) einfach berechnen lassen. Das Ergebnis ist:</p>
<div class="figure">
<img src="assets/16-regression-grillen.assets/image-20211205175741435.png" style="width:40.0%" alt="" />
<p class="caption">image-20211205175741435</p>
</div>
<p>Übrigens lässt sich das auch analytisch berechnen. Sie können das unten nachlesen.</p>
<div id="python" class="section level4 unnumbered">
<h4 class="unnumbered">Python</h4>
<p>Wir erzeugen zunächst die recht einfache Feature Matrix <span class="math inline">\(X \in \mathbb{R}^{11 \times 1}\)</span> und den Label-Vektor <span class="math inline">\(y\in \mathbb{R}^{11}\)</span></p>
<pre><code>from sklearn.linear_model import LinearRegression

X = chirps[&quot;Count&quot;].to_numpy().reshape(11,-1)
y = chirps[&quot;Temp&quot;].to_numpy().reshape(11,-1)
print(y)

reg = LinearRegression().fit(X, y)
print(&quot;weight vector   w = : &quot;, reg.coef_ )
print(&quot;intercept value b = : &quot;, reg.intercept_)

y_pred = reg.predict(X)
print(&quot;              MSE = : &quot;, ((y-y_pred)*(y-y_pred)).sum()/11 )</code></pre>
</div>
</div>
<div id="visualisierung-des-optimalen-modells" class="section level2" number="1.8">
<h2><span class="header-section-number">1.8</span> Visualisierung des optimalen Modells</h2>
<p>Folgende Abbildung zeigt das optimale Modell:</p>
<div class="figure">
<img src="assets/16-regression-grillen.assets/image-20211205180928324.png" style="width:100.0%" alt="" />
<p class="caption">Optmales Modell (d.h. optimale Gerade)</p>
</div>
<div id="python-1" class="section level4 unnumbered">
<h4 class="unnumbered">Python</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>chirps <span class="op">=</span> pd.DataFrame({</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Count&quot;</span>: [<span class="dv">31</span>,<span class="dv">16</span>,<span class="dv">29</span>,<span class="dv">43</span>,<span class="dv">27</span>,<span class="dv">19</span>,<span class="dv">47</span>,<span class="dv">9</span>,<span class="dv">45</span>,<span class="dv">5</span>,<span class="dv">39</span>],</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Temp&quot;</span>: [<span class="fl">9.4</span>,<span class="fl">10.5</span>,<span class="fl">17.1</span>,<span class="fl">24.3</span>,<span class="fl">14.6</span>,<span class="fl">9.9</span>,<span class="fl">16.9</span>,<span class="fl">6.4</span>,<span class="fl">17.7</span>,<span class="fl">7.5</span>,<span class="fl">14.2</span>]    </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> chirps[<span class="st">&quot;Count&quot;</span>].to_numpy().reshape(<span class="dv">11</span>,<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> chirps[<span class="st">&quot;Temp&quot;</span>].to_numpy().reshape(<span class="dv">11</span>,<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> LinearRegression().fit(X, y)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> reg.coef_[<span class="dv">0</span>][<span class="dv">0</span>] </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> reg.intercept_[<span class="dv">0</span>]</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">50</span>])</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>y_values <span class="op">=</span> np.array([b, <span class="dv">50</span><span class="op">*</span>w <span class="op">+</span> b])</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">9</span>))</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>ax.set_aspect(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&quot;Chirps-Data&quot;</span>) </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&quot;Count&quot;</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&quot;Temperature&quot;</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">35</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data <span class="op">=</span> chirps, x <span class="op">=</span> <span class="st">&quot;Count&quot;</span>, y<span class="op">=</span><span class="st">&quot;Temp&quot;</span>, label<span class="op">=</span><span class="st">&quot;Temp&quot;</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span>x_values,y<span class="op">=</span>y_values, color<span class="op">=</span><span class="st">&quot;red&quot;</span>, label<span class="op">=</span><span class="st">&quot;best line xw+b&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="vertiefung-analytische-berechnung-des-optimums" class="section level2" number="1.9">
<h2><span class="header-section-number">1.9</span> Vertiefung : Analytische Berechnung des Optimums </h2>
<p>Wir berechnen (Kandidaten für das Optimum der MSE-Verlustfunktion analytisch:
<span class="math display">\[
L(w,b)  = \sum_{i=0}^{n-1} (x_iw +b -y _i)^2
\]</span>
ist 
<span class="math display">\[
\begin{align}
\frac{\partial L}{\partial w} 
&amp;= 2\sum_{i=0}^{n-1} (x_iw +b -y _i)  x_i  \\
&amp;= 2\sum_{i=0}^{n-1} (x_i^2 w +x_ib -x_iy _i)  \\
&amp;= 2w\sum_{i=0}^{n-1} x_i^2 +2b \sum_{i=0}^{n-1} x_i  - 2\sum_{i=0}^{n-1}x_iy_i 
\end{align}
\]</span>
und
<span class="math display">\[
\begin{align}
\frac{\partial L}{\partial b} 
&amp;= 2\sum_{i=0}^{n-1} (x_i w +b - y_i)   \\
&amp;= 2 w \sum_{i=0}^{n-1} (x_i) + 2nb - 2 \sum_{i=0}^{n-1}y_i 
\end{align}
\]</span>
Setzt man <span class="math inline">\(\frac{\partial L}{\partial w} =0\)</span> , <span class="math inline">\(\frac{\partial L}{\partial b} =0\)</span> , so erhält man zwei lineare Gleichungen, die es erlauben den optimalen Wert <span class="math inline">\(w^*\)</span> und <span class="math inline">\(b^*\)</span> zu berechnen. Für unsere Werte ergibt sich (gerundet, mit Hilfe von Excel und nach Division durch den Faktor von <span class="math inline">\(w^*\)</span>):
<span class="math display">\[
\begin{align}
0 &amp;= w^* + 0,0285503776017683 \cdot b^* - 0,444114938294345 \\
0 &amp;= w^* + 0,0354838709677419 \cdot b^* -0,479032258064516 
\end{align}
\]</span>
und damit
<span class="math display">\[
\begin{align}
 w^* &amp;= 0,300334218870512 \\
b^* &amp;= 5,03603565001285 
\end{align}
\]</span>
Schließlich ergibt sich mit dem entsprechenden Modell als minimaler Loss der Wert 
<span class="math display">\[
8,57336688506454
\]</span></p>
<p>Vergleichen Sie die Werte mit dem Ergebnis oben!</p>
</div>
</div>
<!--bookdown:body:end-->
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong></strong>" was written by . </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
